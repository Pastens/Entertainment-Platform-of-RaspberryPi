<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<input type="text" id="name" />
	<select id="type">
		<option value='1'>歌曲</option>
		<option value='10'>专辑</option>
		<option value='100'>歌手</option>
		<option value='1006'>歌词</option>
	</select>
	<button onclick="submit()">Search</button>


	<table>
		<tbody id="result"></tbody>
	</table>
	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript">
	function submit(){
		var posturl = 'index.php/search';
		$.ajax({
			url: posturl,
			type: 'POST',
			dataType: 'json',
			data: {name: $('#name').val(), type:$('#type').val()},
			success: function (data){
				var result = data.result;
				for(var i=0;i<=20;i++){
					var list = result.songs[i];
					var album = list.album;
					var artist = list.artists[0];
					$('#result').append('<tr><td><img src="'+album.picUrl+'" style="width:50px;height:50px" /></td><td>'+album.name+'</td><td>'+list.name+'</td><td>'+artist.name+'</td><td><button value="'+list.mp3Url+'" onclick="download(this);">点歌</button></td></tr>');
				}

			}
		});	
	};
	function download(obj) {
			var tr = obj.parentNode.parentNode;
			var tds = tr.cells;
			var album = tds[1].innerHTML;
			var name = tds[2].innerHTML;
			var artist = tds[3].innerHTML;
			var url = obj.value;
			$.ajax({
				url: 'index.php/new',
				type: 'POST',
				dataType: 'json',
				data: {
					user: 'hello',
					comment: 'hello',
					music_name: name,
					artist: artist,
					album: album,
					url: url
				},
				success: function () {
					alert('success');
				}
			});	
		};
	</script>
</body>
</html>